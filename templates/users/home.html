{% extends 'base.html' %}
{% load static %}

{% block title %}
  <title>الصفحة الرئيسية للمستخدم</title>
{% endblock %}

{% block content %}
<div class="container py-4">
  <div class="row justify-content-center mb-4">
    <div class="col-lg-8">
      <div class="card shadow-lg border-0 rounded-4 overflow-hidden mb-4">
        <div class="card-header text-center py-5" style="background: linear-gradient(90deg, #8A1538 0%, #b93a5b 100%); color: white;">
          <img src="{% static 'img/user-profile.png' %}" alt="صورة المستخدم" class="rounded-circle mb-3" style="width: 90px; height: 90px; object-fit: cover; border: 4px solid #fff;">
          <h2 class="fw-bold mb-1">مرحباً {{ user.get_full_name|default:user.username }}</h2>
          <p class="mb-0">{{ user.email }}</p>
          <span class="badge bg-light text-dark mt-2">{{ user.profile.role_display|default:'مستخدم' }}</span>
        </div>
        <div class="card-body bg-light">
          <div class="row g-4">
            <div class="col-md-6">
              <div class="info-card p-4 rounded-3 bg-white shadow-sm h-100">
                <h5 class="mb-3"><i class="fas fa-tasks me-2 text-primary"></i>تكليفاتي الحالية</h5>
                {% if assignments %}
                  <ul class="list-group list-group-flush">
                    {% for assignment in assignments %}
                      <li class="list-group-item d-flex justify-content-between align-items-center">
                        <span>{{ assignment.establishment }}</span>
                        <span class="badge rounded-pill bg-{% if assignment.status == 'completed' %}success{% elif assignment.status == 'in_progress' %}info text-dark{% elif assignment.status == 'pending' %}warning text-dark{% else %}secondary{% endif %}">{{ assignment.get_status_display }}</span>
                      </li>
                    {% endfor %}
                  </ul>
                {% else %}
                  <p class="text-muted">لا يوجد تكليفات حالية.</p>
                {% endif %}
              </div>
            </div>
            <div class="col-md-6">
              <div class="info-card p-4 rounded-3 bg-white shadow-sm h-100">
                <h5 class="mb-3"><i class="fas fa-clipboard-check me-2 text-success"></i>معايناتي المنجزة</h5>
                {% if inspections %}
                  <ul class="list-group list-group-flush">
                    {% for inspection in inspections %}
                      <li class="list-group-item d-flex justify-content-between align-items-center">
                        <span>سجل: {{ inspection.get_register }}</span>
                        <span class="badge rounded-pill bg-{% if inspection.status %}success{% else %}danger{% endif %}">{{ inspection.get_status_display }}</span>
                      </li>
                    {% endfor %}
                  </ul>
                {% else %}
                  <p class="text-muted">لا يوجد معاينات منجزة.</p>
                {% endif %}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<style>
  .info-card {
    min-height: 220px;
    border-right: 4px solid #8A1538;
    transition: box-shadow 0.2s;
  }
  .info-card:hover {
    box-shadow: 0 8px 24px rgba(138,21,56,0.10);
  }
  @media (max-width: 767.98px) {
    .info-card { min-height: 160px; }
    .card-header { padding: 2rem 0.5rem !important; }
    .card-body { padding: 1.5rem 0.5rem !important; }
    .card { border-radius: 1.2rem !important; }
  }
</style>
{% endblock %} 